# Lägg till i din configuration.yaml eller sensors.yaml

# REST Sensor för Vättern badtemperatur
rest:
  - resource: "https://portal.loggamera.se/PublicViews/OverviewInside"
    method: POST
    payload: "id=22"
    headers:
      Content-Type: "application/x-www-form-urlencoded"
      User-Agent: "Home Assistant"
    scan_interval: 300  # 5 minuter
    sensor:
      - name: "Vättern Badtemperatur"
        unique_id: "vattern_badtemperatur"
        unit_of_measurement: "°C"
        device_class: "temperature"
        state_class: "measurement"
        icon: "mdi:waves"
        # Extrahera temperatur från HTML med regex eller value_template
        value_template: >-
          {% set html = value %}
          {% set temp_match = html | regex_findall_index('data-value="([0-9.]+)"') %}
          {% if temp_match %}
            {{ temp_match | float | round(1) }}
          {% else %}
            unavailable
          {% endif %}
        availability: >-
          {{ value is defined and value != "" }}
        attributes:
          last_updated: "{{ now().strftime('%Y-%m-%d %H:%M:%S') }}"
          source: "Loggamera Portal"
          location: "Vättern, Hjo" 